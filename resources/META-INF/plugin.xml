<idea-plugin version="2" xmlns:xi="http://www.w3.org/2001/XInclude">
  <id>com.intellij.xml</id>
  <name>XML</name>
  <depends optional="true" config-file="org.intellij.intelliLang.xml">org.intellij.intelliLang</depends>

  <xi:include href="/META-INF/XmlDom.xml" xpointer="xpointer(/idea-plugin/*)" />

  <actions>

    <group id="ToolsXmlGroup" popup="true" class="com.intellij.xml.actions.XmlActionsGroup">
      <action id="ValidateXml" class="com.intellij.xml.actions.validate.ValidateXmlAction"/>
      <action id="GenerateDTD" class="com.intellij.codeInsight.actions.GenerateDTDAction"/>
      <action id="XSD2Document" class="com.intellij.xml.actions.xmlbeans.GenerateSchemaFromInstanceDocumentAction" text="Generate XSD Schema from XML File..."/>
      <action id="Document2XSD" class="com.intellij.xml.actions.xmlbeans.GenerateInstanceDocumentFromSchemaAction" text="Generate XML Document from XSD Schema..."/>
      <separator/>

      <add-to-group group-id="ToolsMenu" anchor="before" relative-to-action="ExternalToolsGroup"/>
    </group>

    <group id="XmlGenerateToolsGroup">
      <separator/>
      <reference ref="GenerateDTD" />
      <reference ref="XSD2Document" />
      <reference ref="Document2XSD" />
      <separator/>
      <add-to-group group-id="EditorPopupMenu" anchor="last"/>
      <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
    </group>

    <reference ref="ValidateXml">
      <add-to-group group-id="EditorPopupMenu.Run" anchor="last"/>
      <add-to-group group-id="ProjectViewPopupMenuRefactoringGroup" anchor="last"/>
      <add-to-group group-id="EditorTabPopupMenuEx" anchor="last"/>
    </reference>



    <group id="NewXml" text="XML">
      <action id="NewHtmlFile" class="com.intellij.ide.actions.CreateHtmlFileAction"/>
      <add-to-group group-id="NewGroup" anchor="before" relative-to-action="NewFromTemplate"/>
    </group>

    <group id="NewXmlDescriptor" class="com.intellij.ide.actions.NonEmptyActionGroup" text="XML Configuration File" popup="true" icon="AllIcons.FileTypes.Xml">
      <add-to-group group-id="NewGroup" anchor="last"/>
    </group>

    <action id="GenerateXmlTag" class="com.intellij.xml.actions.GenerateXmlTagAction"
            text="XML Tag..."
            description="Generate a new XML tag according to schema information">
      <add-to-group group-id="GenerateGroup" anchor="first"/>
    </action>
  </actions>

  <application-components>
    <component>
      <implementation-class>com.intellij.javaee.DefaultHtmlDoctypeInitialConfigurator</implementation-class>
    </component>
  </application-components>

  <project-components>
    <component>
      <implementation-class>com.intellij.codeInsight.daemon.impl.tagTreeHighlighting.XmlTagTreeHighlightingPassFactory
      </implementation-class>
      <skipForDefaultProject/>
    </component>
    <component>
      <implementation-class>com.intellij.xml.breadcrumbs.BreadcrumbsLoaderComponent</implementation-class>
      <skipForDefaultProject/>
    </component>
    <component>
      <interface-class>com.intellij.pom.xml.XmlAspect</interface-class>
      <implementation-class>com.intellij.pom.xml.impl.XmlAspectImpl</implementation-class>
      <!--<loadForDefaultProject/>-->
    </component>

    <component>
      <implementation-class>com.intellij.javaee.PsiExternalResourceNotifier</implementation-class>
    </component>

    <component>
      <implementation-class>com.intellij.xml.XmlPsiManager</implementation-class>
    </component>
  </project-components>

  <extensionPoints>

    <extensionPoint name="startTagEndToken"
                    interface="com.intellij.psi.xml.XmlChildRole$StartTagEndTokenProvider"/>
    <extensionPoint name="schemaProvider"
                    interface="com.intellij.xml.XmlSchemaProvider"/>

    <extensionPoint name="undefinedElementFixProvider" interface="com.intellij.xml.XmlUndefinedElementFixProvider"/>
    <extensionPoint name="xmlExtension"
                    interface="com.intellij.xml.XmlExtension"/>
    <extensionPoint name="tagNameProvider"
                    interface="com.intellij.xml.XmlTagNameProvider"/>
    <extensionPoint name="fileNSInfoProvider"
                    interface="com.intellij.psi.xml.XmlFileNSInfoProvider"/>
    <extensionPoint name="attributeDescriptorsProvider"
                    interface="com.intellij.xml.XmlAttributeDescriptorsProvider"/>
    <extensionPoint name="elementDescriptorProvider"
                    interface="com.intellij.psi.impl.source.xml.XmlElementDescriptorProvider"/>
    <extensionPoint name="util.htmlDoctypeProvider"
                    interface="com.intellij.xml.util.HtmlDoctypeProvider"/>

    <extensionPoint name="xmlSuppressionProvider"
                    interface="com.intellij.codeInspection.XmlSuppressionProvider"/>

    <extensionPoint name="breadcrumbsInfoProvider" interface="com.intellij.xml.breadcrumbs.BreadcrumbsInfoProvider"/>

    <extensionPoint name="breadcrumbsPresentationProvider" interface="com.intellij.xml.breadcrumbs.BreadcrumbsPresentationProvider"/>

    <extensionPoint name="structureViewElementProvider"
                    interface="com.intellij.ide.structureView.xml.XmlStructureViewElementProvider"/>

    <extensionPoint name="structureViewBuilderProvider"
                    interface="com.intellij.ide.structureView.xml.XmlStructureViewBuilderProvider"/>

    <extensionPoint name="webBrowserUrlProvider"
                    interface="com.intellij.ide.browsers.WebBrowserUrlProvider"/>
    <extensionPoint name="remoteFileUpdater"
                    interface="com.intellij.ide.browsers.RemoteFileUpdater"/>

    <extensionPoint name="standardResourceProvider" interface="com.intellij.javaee.StandardResourceProvider"/>
    <extensionPoint name="standardResource" beanClass="com.intellij.javaee.StandardResourceEP"/>

    <extensionPoint name="idContributor"
                    interface="com.intellij.xml.util.XmlIdContributor"/>

    <extensionPoint name="implicitNamespaceDescriptorProvider"
                    interface="com.intellij.javaee.ImplicitNamespaceDescriptorProvider"/>

    <extensionPoint name="relatedToHtmlFilesContributor" interface="com.intellij.navigation.RelatedToHtmlFilesContributor"/>

    <extensionPoint name="tagRuleProvider" interface="com.intellij.xml.XmlTagRuleProvider"/>
    <extensionPoint name="html.embeddedTokenTypesProvider" interface="com.intellij.lexer.HtmlEmbeddedTokenTypesProvider"/>
    <extensionPoint name="html5SchemaProvider" interface="com.intellij.xml.Html5SchemaProvider"/>

    <extensionPoint qualifiedName="org.jetbrains.urlOpener" interface="com.intellij.ide.browsers.UrlOpener"/>

    <extensionPoint name="html.scriptContentProvider"
                    beanClass="com.intellij.lang.LanguageExtensionPoint">
      <with attribute="implementationClass" implements="com.intellij.lang.HtmlScriptContentProvider"/>
    </extensionPoint>

    <extensionPoint name="html.inlineScriptTokenTypesProvider"
                    beanClass="com.intellij.lang.LanguageExtensionPoint">
      <with attribute="implementationClass" implements="com.intellij.lang.HtmlInlineScriptTokenTypesProvider"/>
    </extensionPoint>

    <extensionPoint name="namespaceHelper" interface="com.intellij.xml.XmlNamespaceHelper" />
  </extensionPoints>

  <extensions defaultExtensionNs="com.intellij">
    <fileTypeFactory implementation="com.intellij.xml.XmlFileTypeFactory"/>

    <renameHandler id="xmlTagRenameHandler" implementation="com.intellij.xml.refactoring.XmlTagRenameHandler"/>
    <renameHandler implementation="com.intellij.xml.refactoring.SchemaPrefixRenameHandler" order="before xmlTagRenameHandler"/>
    <refactoring.inlineHandler language="XML" implementationClass="com.intellij.xml.refactoring.XmlInlineHandler"/>

    <completion.contributor language="any" implementationClass="com.intellij.codeInsight.completion.XmlCompletionContributor" id="xml"
                            order="first"/>
    <completion.contributor language="any" implementationClass="com.intellij.codeInsight.completion.XmlNonFirstCompletionContributor" id="xmlNonFirst" order="after xml"/>

    <completion.contributor language="XML" implementationClass="com.intellij.codeInsight.completion.XmlNoVariantsDelegator" order="before xmlNonFirst"/>

    <completion.confidence language="XML" implementationClass="com.intellij.codeInsight.completion.XmlNameCompletionConfidence" id="xml"/>
    <completion.confidence language="HTML" implementationClass="com.intellij.codeInsight.completion.XmlNameCompletionConfidence" id="html"/>

    <lookup.charFilter implementation="com.intellij.codeInsight.completion.XmlCharFilter" id="xml"/>

    <lang.elementManipulator forClass="com.intellij.psi.xml.XmlAttributeValue"
                             implementationClass="com.intellij.psi.impl.source.resolve.reference.impl.manipulators.XmlAttributeValueManipulator"/>
    <lang.elementManipulator forClass="com.intellij.psi.xml.XmlAttribute"
                             implementationClass="com.intellij.psi.impl.source.resolve.reference.impl.manipulators.XmlAttributeManipulator"/>
    <lang.elementManipulator forClass="com.intellij.psi.xml.XmlToken"
                             implementationClass="com.intellij.psi.impl.source.resolve.reference.impl.manipulators.XmlTokenManipulator"/>
    <lang.elementManipulator forClass="com.intellij.psi.xml.XmlTag"
                             implementationClass="com.intellij.psi.impl.source.resolve.reference.impl.manipulators.XmlTagManipulator"/>
    <lang.elementManipulator forClass="com.intellij.psi.xml.XmlText"
                             implementationClass="com.intellij.psi.impl.source.resolve.reference.impl.manipulators.XmlTextManipulator"/>
    <lang.elementManipulator forClass="com.intellij.psi.xml.XmlProcessingInstruction"
                             implementationClass="com.intellij.psi.impl.source.resolve.reference.impl.manipulators.XmlProcessingInstructionManipulator"/>
    <codeInsight.lineMarkerProvider language="HTML" implementationClass="com.intellij.html.HtmlLineMarkerProvider"/>
    <codeInsight.lineMarkerProvider language="XHTML" implementationClass="com.intellij.html.HtmlLineMarkerProvider"/>

    <editorSmartKeysConfigurable instance="com.intellij.application.options.editor.XmlEditorOptionsProvider"/>
    <editorAppearanceConfigurable instance="com.intellij.application.options.editor.XmlEditorAppearanceConfigurable"
                                  id="WebEditorAppearanceConfigurable"/>

    <editorAppearanceConfigurable instance="com.intellij.codeInsight.daemon.impl.tagTreeHighlighting.XmlTagTreeHighlightingConfigurable"/>

    <autoImportOptionsProvider instance="com.intellij.application.options.XmlAutoImportOptionsProvider"/>

    <highlightErrorFilter implementation="com.intellij.codeInsight.highlighting.HtmlClosingTagErrorFilter"/>

    <applicationService serviceInterface="com.intellij.javaee.ExternalResourceManager"
                        serviceImplementation="com.intellij.javaee.ExternalResourceManagerImpl"/>

    <projectService serviceInterface="com.intellij.javaee.ProjectResources"
                    serviceImplementation="com.intellij.javaee.ProjectResources"/>

    <roots.watchedRootsProvider implementation="com.intellij.codeInsight.daemon.impl.quickfix.FetchExtResourceAction"/>

    <fileBasedIndex implementation="com.intellij.xml.index.XmlTagNamesIndex"/>
    <fileBasedIndex implementation="com.intellij.xml.index.XmlNamespaceIndex"/>
    <fileBasedIndex implementation="com.intellij.html.index.Html5CustomAttributesIndex"/>
    <fileBasedIndex implementation="com.intellij.xml.index.SchemaTypeInheritanceIndex"/>
    <include.provider implementation="com.intellij.xml.util.XIncludeProvider"/>
    <indexedRootsProvider implementation="com.intellij.javaee.ExternalResourcesRootsProvider"/>

    <applicationService serviceInterface="com.intellij.application.options.editor.XmlEditorOptions"
                        serviceImplementation="com.intellij.application.options.editor.XmlEditorOptions"/>
    <exportable serviceInterface="com.intellij.application.options.editor.XmlEditorOptions"/>


    <applicationService serviceInterface="com.intellij.application.options.editor.XmlFoldingSettings"
                        serviceImplementation="com.intellij.application.options.editor.XmlFoldingSettings"/>

    <exportable serviceInterface="com.intellij.application.options.editor.XmlFoldingSettings"/>

    <applicationService serviceInterface="com.intellij.application.options.XmlSettings"
                        serviceImplementation="com.intellij.application.options.XmlSettings"/>
    <exportable serviceInterface="com.intellij.application.options.XmlSettings"/>

    <applicationService serviceInterface="com.intellij.ide.browsers.BrowsersConfiguration"
                        serviceImplementation="com.intellij.ide.browsers.BrowsersConfiguration"/>

    <projectService serviceInterface="com.intellij.psi.XmlElementFactory"
                    serviceImplementation="com.intellij.psi.XmlElementFactoryImpl"/>

    <highlightVisitor implementation="com.intellij.codeInsight.daemon.impl.analysis.XmlHighlightVisitor"/>

    <externalAnnotator language="XML" implementationClass="com.intellij.lang.xml.XMLExternalAnnotator"/>
    <externalAnnotator language="HTML" implementationClass="com.intellij.lang.xml.XMLExternalAnnotator"/>
    <externalAnnotator language="XHTML" implementationClass="com.intellij.lang.xml.XMLExternalAnnotator"/>
    <externalAnnotator language="JSP" implementationClass="com.intellij.lang.xml.XMLExternalAnnotator"/>
    <externalAnnotator language="JSPX" implementationClass="com.intellij.lang.xml.XMLExternalAnnotator"/>

    <lang.parserDefinition language="DTD" implementationClass="com.intellij.lang.dtd.DTDParserDefinition"/>
    <lang.parserDefinition language="XML" implementationClass="com.intellij.lang.xml.XMLParserDefinition"/>
    <lang.parserDefinition language="HTML" implementationClass="com.intellij.lang.html.HTMLParserDefinition"/>
    <lang.parserDefinition language="XHTML" implementationClass="com.intellij.lang.xhtml.XHTMLParserDefinition"/>

    <lang.formatter language="XML" implementationClass="com.intellij.lang.xml.XmlFormattingModelBuilder"/>
    <lang.whiteSpaceFormattingStrategy language="XML"
                                       implementationClass="com.intellij.lang.xml.XmlWhiteSpaceFormattingStrategy"/>
    <lang.formatter language="HTML" implementationClass="com.intellij.lang.html.HtmlFormattingModelBuilder"/>
    <lang.formatter language="XHTML" implementationClass="com.intellij.lang.xhtml.XhtmlFormattingModelBuilder"/>
    <lang.lineWrapStrategy language="XML" implementationClass="com.intellij.psi.formatter.MarkupLineWrapPositionStrategy"/>
    <lang.lineWrapStrategy language="HTML" implementationClass="com.intellij.psi.formatter.MarkupLineWrapPositionStrategy"/>
    <lang.lineWrapStrategy language="XHTML" implementationClass="com.intellij.psi.formatter.MarkupLineWrapPositionStrategy"/>

    <lang.documentationProvider language="XML" implementationClass="com.intellij.xml.util.documentation.XmlDocumentationProvider"
                                order="last"/>
    <lang.documentationProvider language="DTD" implementationClass="com.intellij.xml.util.documentation.XmlDocumentationProvider"/>
    <lang.documentationProvider language="HTML" implementationClass="com.intellij.xml.util.documentation.HtmlDocumentationProvider"/>
    <lang.documentationProvider language="XHTML" implementationClass="com.intellij.xml.util.documentation.XHtmlDocumentationProvider"/>

    <lang.surroundDescriptor language="XML" implementationClass="com.intellij.lang.xml.XmlSurroundDescriptor"/>
    <lang.surroundDescriptor language="HTML" implementationClass="com.intellij.lang.xml.XmlSurroundDescriptor" id="html-xml"/>
    <lang.surroundDescriptor language="XHTML" implementationClass="com.intellij.lang.xml.XmlSurroundDescriptor"/>

    <lang.unwrapDescriptor language="XML" implementationClass="com.intellij.lang.xml.XmlUnwrapDescriptor"/>
    <lang.unwrapDescriptor language="HTML" implementationClass="com.intellij.lang.xml.XmlUnwrapDescriptor"/>
    <lang.unwrapDescriptor language="XHTML" implementationClass="com.intellij.lang.xml.XmlUnwrapDescriptor"/>
    <lang.unwrapDescriptor language="JSP" implementationClass="com.intellij.lang.xml.XmlUnwrapDescriptor"/>
    <lang.unwrapDescriptor language="JSPX" implementationClass="com.intellij.lang.xml.XmlUnwrapDescriptor"/>

    <lang.findUsagesProvider language="DTD" implementationClass="com.intellij.lang.xml.XmlFindUsagesProvider"/>
    <lang.findUsagesProvider language="XML" implementationClass="com.intellij.lang.xml.XmlFindUsagesProvider"/>
    <lang.findUsagesProvider language="HTML" implementationClass="com.intellij.lang.xml.XmlFindUsagesProvider"/>
    <lang.findUsagesProvider language="XHTML" implementationClass="com.intellij.lang.xml.XmlFindUsagesProvider"/>

    <lang.commenter language="DTD" implementationClass="com.intellij.lang.xml.XmlCommenter"/>
    <lang.commenter language="XML" implementationClass="com.intellij.lang.xml.XmlCommenter"/>
    <lang.commenter language="HTML" implementationClass="com.intellij.lang.xml.XmlCommenter"/>
    <lang.commenter language="XHTML" implementationClass="com.intellij.lang.xml.XmlCommenter"/>

    <braceMatcher filetype="XML" implementationClass="com.intellij.xml.impl.XmlBraceMatcher"/>
    <braceMatcher filetype="DTD" implementationClass="com.intellij.xml.impl.XmlBraceMatcher"/>
    <braceMatcher filetype="XHTML" implementationClass="com.intellij.xml.impl.XmlBraceMatcher"/>
    <braceMatcher filetype="HTML" implementationClass="com.intellij.xml.impl.XmlBraceMatcher"/>

    <lang.foldingBuilder language="DTD" implementationClass="com.intellij.lang.xml.XmlFoldingBuilder"/>
    <lang.foldingBuilder language="XML" implementationClass="com.intellij.lang.xml.XmlFoldingBuilder"/>
    <lang.foldingBuilder language="HTML" implementationClass="com.intellij.lang.xml.XmlFoldingBuilder"/>
    <lang.foldingBuilder language="XHTML" implementationClass="com.intellij.lang.xml.XmlFoldingBuilder"/>

    <codeInsight.parameterInfo language="XML" implementationClass="com.intellij.codeInsight.hint.api.impls.XmlParameterInfoHandler"/>
    <codeInsight.parameterInfo language="HTML" implementationClass="com.intellij.codeInsight.hint.api.impls.XmlParameterInfoHandler"/>
    <codeInsight.parameterInfo language="XHTML" implementationClass="com.intellij.codeInsight.hint.api.impls.XmlParameterInfoHandler"/>

    <codeInsight.wordCompletionFilter language="XML" implementationClass="com.intellij.lang.xml.XmlWordCompletionFilter"/>
    <codeInsight.wordCompletionFilter language="HTML" implementationClass="com.intellij.lang.xml.XmlWordCompletionFilter"/>
    <codeInsight.wordCompletionFilter language="XHTML" implementationClass="com.intellij.lang.xml.XmlWordCompletionFilter"/>
    <codeInsight.wordCompletionFilter language="JSP" implementationClass="com.intellij.lang.xml.XmlWordCompletionFilter"/>
    <codeInsight.wordCompletionFilter language="JSPX" implementationClass="com.intellij.lang.xml.XmlWordCompletionFilter"/>


    <lang.psiStructureViewFactory language="DTD" implementationClass="com.intellij.lang.dtd.DtdStructureViewBuilderFactory"/>
    <lang.psiStructureViewFactory language="XML" implementationClass="com.intellij.lang.xml.XmlStructureViewBuilderFactory"/>
    <lang.psiStructureViewFactory language="HTML" implementationClass="com.intellij.lang.xml.XmlStructureViewBuilderFactory"/>
    <lang.psiStructureViewFactory language="XHTML" implementationClass="com.intellij.lang.xml.XmlStructureViewBuilderFactory"/>

    <lang.ast.lazyFactory implementation="com.intellij.lang.xml.XmlASTLazyFactory" />
    <lang.ast.compositeFactory implementation="com.intellij.lang.xml.XmlASTCompositeFactory" />
    <lang.ast.leafFactory implementation="com.intellij.lang.xml.XmlASTLeafFactory" />

    <codeStyleSettingsProvider implementation="com.intellij.application.options.XmlCodeStyleSettingsProvider"/>
    <codeStyleSettingsProvider implementation="com.intellij.application.options.HtmlCodeStyleSettingsProvider"/>
    <langCodeStyleSettingsProvider implementation="com.intellij.application.options.HtmlLanguageCodeStyleSettings"/>

    <!-- XML -->
    <quoteHandler fileType="XML" className="com.intellij.codeInsight.editorActions.XmlQuoteHandler"/>
    <quoteHandler fileType="HTML" className="com.intellij.codeInsight.editorActions.HtmlQuoteHandler"/>
    <quoteHandler fileType="XHTML" className="com.intellij.codeInsight.editorActions.HtmlQuoteHandler"/>

    <completionData fileType="XML" className="com.intellij.codeInsight.completion.XmlCompletionData"/>
    <completionData fileType="HTML" className="com.intellij.codeInsight.completion.HtmlCompletionData"/>
    <completionData fileType="XHTML" className="com.intellij.codeInsight.completion.XHtmlCompletionData"/>
    <completionData fileType="DTD" className="com.intellij.codeInsight.completion.DtdCompletionData"/>

    <psi.referenceContributor implementation="com.intellij.xml.util.XmlReferenceContributor"/>
    <!--<pom.declarationSearcher implementation="com.intellij.psi.impl.source.resolve.reference.impl.providers.IdDeclarationSearcher"/>-->
    <anchorReferenceProvider implementation="com.intellij.xml.util.AnchorPathReferenceProvider"/>

    <extendWordSelectionHandler implementation="com.intellij.codeInsight.editorActions.HtmlSelectioner"/>
    <extendWordSelectionHandler implementation="com.intellij.codeInsight.editorActions.XmlTagSelectioner"/>
    <extendWordSelectionHandler implementation="com.intellij.codeInsight.editorActions.XmlCDATAContentSelectioner"/>
    <extendWordSelectionHandler implementation="com.intellij.codeInsight.editorActions.DtdSelectioner"/>
    <extendWordSelectionHandler implementation="com.intellij.codeInsight.editorActions.XmlElementSelectioner"/>
    <extendWordSelectionHandler implementation="com.intellij.codeInsight.editorActions.XmlTokenSelectioner"/>
    <extendWordSelectionHandler implementation="com.intellij.codeInsight.editorActions.XmlLineSelectioner"/>


    <typedHandler implementation="com.intellij.codeInsight.editorActions.XmlSlashTypedHandler" id="xmlSlash"/>
    <typedHandler implementation="com.intellij.codeInsight.editorActions.XmlEqTypedHandler" id="xmlEq"/>
    <typedHandler implementation="com.intellij.codeInsight.editorActions.XmlGtTypedHandler" id="xmlGt"/>
    <typedHandler implementation="com.intellij.codeInsight.editorActions.XmlAutoPopupHandler" id="xmlAuto"/>

    <!--
    <copyPastePreProcessor implementation="com.intellij.codeInsight.editorActions.XmlCopyPastePreProcessor"/>
    -->

    <syntaxHighlighter key="CONSULO_PROJECT" implementationClass="com.intellij.ide.highlighter.XmlFileHighlighter"/>
    <syntaxHighlighter key="CONSULO_MODULE" implementationClass="com.intellij.ide.highlighter.XmlFileHighlighter"/>
    <syntaxHighlighter key="CONSULO_WORKSPACE" implementationClass="com.intellij.ide.highlighter.XmlFileHighlighter"/>
    <syntaxHighlighter key="GUI_DESIGNER_FORM" implementationClass="com.intellij.ide.highlighter.XmlFileHighlighter"/>

    <enterHandlerDelegate implementation="com.intellij.codeInsight.editorActions.EnterBetweenXmlTagsHandler" id="xmlEnter"/>

    <declarationRangeHandler key="com.intellij.psi.xml.XmlTag"
                             implementationClass="com.intellij.codeInsight.hint.TagDeclarationRangeHandler"/>

    <liveTemplateContext implementation="com.intellij.codeInsight.template.HtmlTextContextType"/>
    <liveTemplateContext implementation="com.intellij.codeInsight.template.HtmlContextType"/>
    <liveTemplateContext implementation="com.intellij.codeInsight.template.XslTextContextType"/>
    <liveTemplateContext implementation="com.intellij.codeInsight.template.XmlContextType"/>

    <errorQuickFixProvider implementation="com.intellij.codeInsight.daemon.impl.analysis.XmlErrorQuickFixProvider"/>

    <elementDescriptionProvider implementation="com.intellij.refactoring.util.XmlNonCodeSearchElementDescriptionProvider"/>

    <referenceProviderType key="Uri references provider"
                           implementationClass="com.intellij.psi.impl.source.resolve.reference.impl.providers.URIReferenceProvider"/>
    <referenceProviderType key="Schema references provider"
                           implementationClass="com.intellij.psi.impl.source.resolve.reference.impl.providers.SchemaReferencesProvider"/>

    <renamePsiElementProcessor implementation="com.intellij.refactoring.rename.RenameXmlAttributeProcessor" id="xmlAttribute"/>
    <lang.importOptimizer id="XML" language="XML" implementationClass="com.intellij.refactoring.XmlImportOptimizer"/>

    <readWriteAccessDetector implementation="com.intellij.codeInsight.highlighting.XmlReadWriteAccessDetector"/>

    <elementDescriptionProvider implementation="com.intellij.usageView.XmlUsageViewDescriptionProvider"/>

    <langCodeStyleSettingsProvider implementation="com.intellij.application.options.XmlLanguageCodeStyleSettingsProvider"/>

    <methodNavigationOffsetProvider implementation="com.intellij.codeInsight.navigation.XmlMethodNavigationOffsetProvider" order="last"/>

    <annotator language="XML" implementationClass="com.intellij.codeInspection.htmlInspections.XmlWrongClosingTagNameInspection"/>

    <statementUpDownMover implementation="com.intellij.codeInsight.editorActions.moveUpDown.XmlMover" id="xml" order="before line"/>

    <applicationService serviceInterface="com.intellij.ide.browsers.WebBrowserService"
                        serviceImplementation="com.intellij.ide.browsers.impl.WebBrowserServiceImpl"/>

    <patterns.patternClass className="com.intellij.patterns.XmlPatterns" alias="xml"/>

    <lang.smartEnterProcessor language="XML" implementationClass="com.intellij.codeInsight.completion.XmlSmartEnterProcessor"/>
    <lang.smartEnterProcessor language="HTML" implementationClass="com.intellij.codeInsight.completion.XmlSmartEnterProcessor"/>
    <lang.smartEnterProcessor language="XHTML" implementationClass="com.intellij.codeInsight.completion.XmlSmartEnterProcessor"/>

    <iconDescriptorUpdater implementation="com.intellij.xml.util.XmlIconDescriptorUpdater" id="xml"/>

    <localInspection language="XML" shortName="CheckTagEmptyBody" bundle="messages.XmlBundle" key="xml.inspections.check.tag.empty.body"
                     groupKey="xml.inspections.group.name" enabledByDefault="true" level="WARNING"
                     implementationClass="com.intellij.xml.util.CheckTagEmptyBodyInspection"/>
    <!-- TODO: assign it to XML & DTD -->
    <localInspection shortName="CheckDtdRefs" bundle="messages.XmlBundle" key="xml.inspections.check.dtd.references" groupName="XML"
                     enabledByDefault="true" level="ERROR" implementationClass="com.intellij.xml.util.CheckDtdReferencesInspection"/>
    <localInspection language="XML" shortName="CheckEmptyScriptTag" bundle="messages.XmlBundle" key="html.inspections.check.empty.tag"
                     groupName="HTML"
                     enabledByDefault="true" level="WARNING" implementationClass="com.intellij.xml.util.CheckEmptyTagInspection"/>
    <localInspection language="XML" shortName="CheckValidXmlInScriptTagBody" bundle="messages.XmlBundle"
                     key="html.inspections.check.valid.script.tag"
                     groupName="HTML" enabledByDefault="true" level="ERROR"
                     implementationClass="com.intellij.xml.util.CheckValidXmlInScriptBodyInspection"/>
    <localInspection language="XML" shortName="CheckXmlFileWithXercesValidator" bundle="messages.XmlBundle"
                     key="xml.inspections.check.file.with.xerces"
                     groupName="XML" enabledByDefault="true" level="ERROR"
                     implementationClass="com.intellij.xml.util.CheckXmlFileWithXercesValidatorInspection" unfair="true"/>

    <localInspection language="XML" bundle="messages.XmlBundle" key="xml.inspections.duplicate.id"
                     groupKey="xml.inspections.group.name" enabledByDefault="true" level="ERROR" runForWholeFile="true" unfair="true"
                     implementationClass="com.intellij.xml.util.XmlDuplicatedIdInspection"/>
    <localInspection language="XML" bundle="messages.XmlBundle" key="xml.inspections.invalid.id"
                     groupKey="xml.inspections.group.name" enabledByDefault="true" level="ERROR" runForWholeFile="true" unfair="true"
                     implementationClass="com.intellij.xml.util.XmlInvalidIdInspection"/>

    <localInspection language="XML" shortName="RequiredAttributes" bundle="messages.InspectionsBundle"
                     key="inspection.required.attributes.display.name"
                     groupName="HTML" enabledByDefault="true" level="WARNING"
                     implementationClass="com.intellij.codeInspection.htmlInspections.RequiredAttributesInspection" unfair="true"/>
    <localInspection language="XML" shortName="HtmlExtraClosingTag" bundle="messages.XmlBundle" key="html.inspection.extra.closing.tag"
                     groupName="HTML"
                     enabledByDefault="true" level="ERROR"
                     implementationClass="com.intellij.codeInspection.htmlInspections.HtmlExtraClosingTagInspection"/>
    <localInspection language="XML" shortName="XmlWrongRootElement" bundle="messages.XmlBundle" key="xml.inspection.wrong.root.element"
                     groupName="XML"
                     enabledByDefault="true" level="ERROR"
                     implementationClass="com.intellij.codeInspection.htmlInspections.XmlWrongRootElementInspection"/>
    <localInspection language="XML" shortName="HtmlUnknownTag" bundle="messages.XmlBundle" key="html.inspections.unknown.tag"
                     groupName="HTML"
                     enabledByDefault="true" level="WARNING"
                     implementationClass="com.intellij.codeInspection.htmlInspections.HtmlUnknownTagInspection"/>
    <localInspection language="XML" shortName="HtmlUnknownAttribute" bundle="messages.XmlBundle" key="html.inspections.unknown.attribute"
                     groupName="HTML"
                     enabledByDefault="true" level="WARNING"
                     implementationClass="com.intellij.codeInspection.htmlInspections.HtmlUnknownAttributeInspection"/>
    <localInspection language="XML" shortName="XmlUnboundNsPrefix" bundle="messages.XmlBundle" key="xml.inspections.unbound.prefix"
                     groupKey="xml.inspections.group.name" enabledByDefault="true" level="WARNING"
                     implementationClass="com.intellij.codeInsight.daemon.impl.analysis.XmlUnboundNsPrefixInspection"/>
    <localInspection language="XML" shortName="XmlUnusedNamespaceDeclaration" displayName="Unused XML schema declaration"
                     groupKey="xml.inspections.group.name" bundle="messages.XmlBundle" enabledByDefault="true" level="WARNING"
                     implementationClass="com.intellij.codeInsight.daemon.impl.analysis.XmlUnusedNamespaceInspection"/>
    <localInspection language="XML" implementationClass="com.intellij.codeInsight.daemon.impl.analysis.XmlPathReferenceInspection"
                     displayName="File path resolving in XML"
                     groupName="XML" enabledByDefault="true" level="ERROR"/>
    <localInspection language="XML" shortName="HtmlUnknownTarget" bundle="messages.XmlBundle" key="html.inspections.unknown.target"
                     groupName="HTML"
                     enabledByDefault="true" level="WARNING"
                     implementationClass="com.intellij.codeInsight.daemon.impl.analysis.HtmlUnknownTargetInspection"/>
    <localInspection language="XML" shortName="HtmlUnknownAnchorTarget" bundle="messages.XmlBundle" key="html.inspections.unknown.anchor"
                     groupName="HTML"
                     enabledByDefault="true" level="WARNING"
                     implementationClass="com.intellij.codeInsight.daemon.impl.analysis.HtmlUnknownAnchorTargetInspection"/>


    <globalInspection shortName="XmlHighlighting" displayName="XML highlighting" groupName="General" enabledByDefault="true" level="ERROR"
                      implementationClass="com.intellij.codeInsight.daemon.impl.analysis.XmlHighlightVisitorBasedInspection"/>

    <codeFoldingOptionsProvider instance="com.intellij.application.options.editor.XmlCodeFoldingOptionsProvider"/>

    <colorSettingsPage implementation="com.intellij.openapi.options.colors.pages.XMLColorsPage"/>
    <colorSettingsPage implementation="com.intellij.openapi.options.colors.pages.HTMLColorsPage"/>

    <metaDataContributor implementation="com.intellij.xml.util.XmlApplicationComponent"/>

    <browserSettingsProvider instance="com.intellij.ide.browsers.impl.BrowserSettingsProviderImpl"/>

    <multiHostInjector forClass="com.intellij.psi.PsiComment"
                       implementationClass="com.intellij.psi.impl.source.html.HtmlConditionalCommentInjector"/>
    <multiHostInjector forClass="com.intellij.psi.xml.XmlText"
                       implementationClass="com.intellij.psi.impl.source.html.HtmlScriptLanguageInjector"/>

    <gotoRelatedProvider implementation="com.intellij.navigation.HtmlGotoRelatedProvider"/>

    <intentionAction>
      <category>XML</category>
      <className>com.intellij.xml.actions.XmlSplitTagAction</className>
    </intentionAction>
    <intentionAction>
      <category>XML</category>
      <className>com.intellij.codeInsight.daemon.impl.analysis.AddSchemaPrefixIntention</className>
    </intentionAction>

    <intentionAction>
      <category>XML</category>
      <className>com.intellij.codeInsight.daemon.impl.quickfix.AddXsiSchemaLocationForExtResourceAction</className>
    </intentionAction>
    <intentionAction>
      <category>XML</category>
      <className>com.intellij.codeInsight.daemon.impl.quickfix.ManuallySetupExtResourceAction</className>
    </intentionAction>

    <intentionAction>
      <category>XML</category>
      <className>com.intellij.codeInsight.daemon.impl.analysis.ConvertSchemaPrefixToDefaultIntention</className>
    </intentionAction>
    <intentionAction>
      <category>XML</category>
      <className>com.intellij.codeInsight.intentions.XmlChooseColorIntentionAction</className>
    </intentionAction>

    <lang.implementationTextSelectioner language="XML"
                                        implementationClass="com.intellij.codeInsight.hint.XmlImplementationTextSelectioner"/>
    <basicWordSelectionFilter implementation="com.intellij.codeInsight.editorActions.XmlBasicWordSelectionFilter"/>
    <defaultLiveTemplatesProvider implementation="com.intellij.codeInsight.template.XmlDefaultLiveTemplatesProvider"/>
    <productivityFeaturesProvider implementation="com.intellij.featureStatistics.XmlProductivityFeatureProvider"/>

    <idIndexer filetype="XML" implementationClass="com.intellij.psi.impl.cache.impl.idCache.XmlIdIndexer"/>
    <idIndexer filetype="DTD" implementationClass="com.intellij.psi.impl.cache.impl.idCache.XmlIdIndexer"/>
    <idIndexer filetype="HTML" implementationClass="com.intellij.psi.impl.cache.impl.idCache.HtmlIdIndexer"/>
    <idIndexer filetype="XHTML" implementationClass="com.intellij.psi.impl.cache.impl.idCache.XHtmlIdIndexer"/>

    <todoIndexer filetype="XML" implementationClass="com.intellij.psi.impl.cache.impl.idCache.XmlTodoIndexer"/>
    <todoIndexer filetype="DTD" implementationClass="com.intellij.psi.impl.cache.impl.idCache.XmlTodoIndexer"/>
    <todoIndexer filetype="HTML" implementationClass="com.intellij.psi.impl.cache.impl.idCache.HtmlTodoIndexer"/>
    <todoIndexer filetype="XHTML" implementationClass="com.intellij.psi.impl.cache.impl.idCache.XHtmlTodoIndexer"/>

    <elementSignatureProvider implementation="com.intellij.codeInsight.folding.impl.XmlElementSignatureProvider"/>

    <vcsSelectionProvider implementation="com.intellij.vcsUtil.XmlVcsSelectionProvider"/>

    <renameInputValidator implementation="com.intellij.lang.xml.XmlElementRenameValidator"/>
    <renameInputValidator implementation="com.intellij.lang.xml.XmlAttributeValueRenameValidator"/>

    <daemon.changeLocalityDetector implementation="com.intellij.xml.XmlChangeLocalityDetector"/>
    <lang.rearranger language="XML" implementationClass="com.intellij.xml.arrangement.XmlRearranger"/>
    <definitionsSearch implementation="com.intellij.xml.impl.schema.SchemaDefinitionsSearch"/>


    <projectConfigurable instance="com.intellij.javaee.ExternalResourceConfigurable" key="display.name.edit.external.resource"
                         bundle="messages.XmlBundle" id="preferences.externalResources">
      <configurable instance="com.intellij.javaee.XMLCatalogConfigurable" displayName="XML Catalog" id="xml.catalog"/>
    </projectConfigurable>

    <selectInTarget implementation="com.intellij.ide.browsers.SelectInDefaultBrowserTarget"/>
  </extensions>

  <extensions defaultExtensionNs="com.intellij.copyright">
    <updater filetype="XML" implementationClass="com.maddyhome.idea.copyright.psi.UpdateXmlCopyrightsProvider"/>
    <updater filetype="HTML" implementationClass="com.maddyhome.idea.copyright.psi.UpdateXmlCopyrightsProvider"/>
  </extensions>

  <extensions defaultExtensionNs="com.intellij.xml">
    <tagNameProvider implementation="com.intellij.psi.impl.source.xml.DefaultXmlTagNameProvider"/>
    <attributeDescriptorsProvider implementation="com.intellij.html.impl.Html5CustomAttributeDescriptorsProvider"/>
    <attributeDescriptorsProvider implementation="com.intellij.html.impl.MicrodataAttributeDescriptorsProvider"/>

    <breadcrumbsPresentationProvider
        implementation="com.intellij.codeInsight.daemon.impl.tagTreeHighlighting.XmlTagTreeBreadcrumbsPresentationProvider"/>

    <structureViewBuilderProvider implementation="com.intellij.lang.html.structureView.HtmlStructureViewBuilderProvider"/>
    <relatedToHtmlFilesContributor implementation="com.intellij.navigation.LinkedToHtmlFilesContributor"/>
    <xmlSuppressionProvider implementation="com.intellij.codeInspection.DefaultXmlSuppressionProvider" order="last"/>
    <breadcrumbsInfoProvider implementation="com.intellij.xml.breadcrumbs.XmlLanguageBreadcrumbsInfoProvider"/>
    <standardResourceProvider implementation="com.intellij.javaee.InternalResourceProvider"/>
  </extensions>

  <extensions defaultExtensionNs="org.jetbrains">
    <urlOpener implementation="com.intellij.ide.browsers.impl.DefaultUrlOpener" order="last"/>
  </extensions>
</idea-plugin>